<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="canonical" href="https://soyth.ch/en/ImageCompressor.html" />
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta
      name="description"
      content="Compress images directly in the browser with Soyth's free, open-source Image Compressor. Balance file size reduction with quality preservation using the Canvas API."
    />
    <meta
      name="keywords"
      content="Image Compressor, Soyth, image compression, Canvas API, JPEG, PNG, file size reduction, JavaScript, Business IT tools"
    />
    <meta name="author" content="Soyth" />
    <title>Soyth - Image Compressor</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500&display=swap"
      rel="stylesheet"
    />
    <link rel="icon" href="../favicon/favicon.ico" type="image/x-icon" />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="../favicon/favicon-16x16.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="../favicon/favicon-32x32.png"
    />
    <link rel="apple-touch-icon" href="../favicon/apple-touch-icon.png" />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="../favicon/android-chrome-192x192.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="512x512"
      href="../favicon/android-chrome-512x512.png"
    />
    <link rel="manifest" href="../favicon/site.webmanifest" />
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
      integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="../css/styles.css" />
    <link rel="stylesheet" href="../css/tools/ImageCompressor.css" />
    <link
      rel="alternate"
      hreflang="en"
      href="https://soyth.ch/en/ImageCompressor.html"
    />
    <link
      rel="alternate"
      hreflang="de"
      href="https://soyth.ch/de/ImageCompressor.html"
    />
    <link
      rel="alternate"
      hreflang="fr"
      href="https://soyth.ch/fr/ImageCompressor.html"
    />
    <link
      rel="alternate"
      hreflang="it"
      href="https://soyth.ch/it/ImageCompressor.html"
    />
    <link
      rel="alternate"
      hreflang="rm"
      href="https://soyth.ch/rm/ImageCompressor.html"
    />
    <link
      rel="alternate"
      hreflang="x-default"
      href="https://soyth.ch/en/ImageCompressor.html"
    />
  </head>
  <body>
    <div class="cookie-banner" id="cookieBanner">
      <div class="cookie-content">
        <p>
          We use cookies to ensure site performance. Essential cookies are
          necessary, while others help us understand usage patterns and support
          marketing. Learn more in our
          <a href="/en/cookie-policy.html" target="_blank">Cookie Policy</a>.
        </p>
        <div class="cookie-buttons">
          <button class="cookie-btn" onclick="showModal('cookiePreferences')">
            Manage Cookies
          </button>
          <button class="cookie-btn" onclick="rejectNonEssentialCookies()">
            Reject Non-Essential
          </button>
          <button
            class="cookie-btn cookie-btn-primary"
            onclick="acceptAllCookies()"
          >
            Accept All
          </button>
        </div>
      </div>
    </div>

    <header>
      <div class="header-content">
        <div class="logo">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="var(--text-primary)"
            stroke-width="1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
          >
            <path
              d="M6,4 L18,4 L22,12 L18,20 L6,20 L2,12 Z M12,8 A4,4 0 0,1 16,12 A4,4 0 0,1 12,16"
            />
          </svg>
          <a
            href="https://soyth.ch/en/"
            style="text-decoration: none; color: inherit"
            >Soyth</a
          >
        </div>
        <div class="burger-menu" onclick="toggleMobileMenu()">
          <div class="burger-line"></div>
          <div class="burger-line"></div>
          <div class="burger-line"></div>
        </div>
        <nav class="nav-desktop">
          <a href="#" class="nav-link" onclick="showProjectsMenu()">Projects</a>
          <a href="#" class="nav-link" onclick="showModal('about')">About</a>
          <a href="#" class="nav-link" onclick="showModal('skills')">Skills</a>
          <a href="#" class="nav-link" onclick="showModal('cookies')"
            >Cookies</a
          >
          <a href="#" class="nav-link" onclick="showModal('contact')"
            >Contact</a
          >
          <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle">
            <span id="themeIcon">Dark</span>
          </button>
        </nav>
        <nav class="nav-mobile" id="mobileNav">
          <a
            href="#"
            class="nav-link"
            onclick="showProjectsMenu(); closeMobileMenu()"
            >Projects</a
          >
          <a
            href="#"
            class="nav-link"
            onclick="showModal('about'); closeMobileMenu()"
            >About</a
          >
          <a
            href="#"
            class="nav-link"
            onclick="showModal('skills'); closeMobileMenu()"
            >Skills</a
          >
          <a
            href="#"
            class="nav-link"
            onclick="showModal('cookies'); closeMobileMenu()"
            >Cookies</a
          >
          <a
            href="#"
            class="nav-link"
            onclick="showModal('contact'); closeMobileMenu()"
            >Contact</a
          >
          <button
            class="theme-toggle"
            onclick="toggleTheme()"
            style="margin: 0; align-self: center"
          >
            <span id="mobileThemeIcon">Dark</span>
          </button>
        </nav>
        <nav class="nav-projects" id="projectsNav">
          <div class="back-arrow" onclick="closeProjectsMenu()">
            <div class="back-line"></div>
            <div class="back-line"></div>
          </div>
          <a href="https://soyth.ch/en/HTMLCompiler.html" class="nav-link"
            >HTML Compiler</a
          >
          <a href="https://soyth.ch/en/PasswordGenerator.html" class="nav-link"
            >Password Generator</a
          >
          <a href="https://soyth.ch/en/TextFormatter.html" class="nav-link"
            >Text Formatter</a
          >
          <a href="https://soyth.ch/en/UnitConverter.html" class="nav-link"
            >Unit Converter</a
          >
          <a href="https://soyth.ch/en/QRCodeGenerator.html" class="nav-link"
            >QR Code Generator</a
          >
          <a href="https://soyth.ch/en/ColorConverter.html" class="nav-link"
            >Color Converter</a
          >
          <a href="https://soyth.ch/en/Translator.html" class="nav-link"
            >Soyth Translator</a
          >
          <a href="https://soyth.ch/en/ImageCompressor.html" class="nav-link"
            >Image Compressor</a
          >
          <a href="https://soyth.ch/en/JSONFormatter.html" class="nav-link"
            >JSON Formatter</a
          >
          <a href="https://soyth.ch/en/UUIDGenerator.html" class="nav-link"
            >UUID Generator</a
          >
          <a
            href="https://soyth.ch/en/LoremIpsumGenerator.html"
            class="nav-link"
            >Lorem Ipsum Generator</a
          >
          <a href="https://soyth.ch/en/PomodoroTimer.html" class="nav-link"
            >Pomodoro Timer</a
          >
          <a href="https://soyth.ch/en/TimestampConverter.html" class="nav-link"
            >Timestamp Converter</a
          >
        </nav>
      </div>
    </header>
    <button id="scrollButton" class="scroll-btn" onclick="scrollToDirection()">
      <i class="fas fa-arrow-up"></i>
    </button>

    <main>
      <section class="image-compressor">
        <h1>Image Compressor</h1>
        <div class="image-options">
          <div class="image-option">
            <label for="imageInput">Select Image:</label>
            <button
              class="btn btn-secondary select-image-btn"
              onclick="document.getElementById('imageInput').click()"
            >
              Choose Image
            </button>
            <input
              type="file"
              id="imageInput"
              accept="image/jpeg,image/png"
              style="display: none"
            />
            <div class="file-name" id="fileName">No file chosen</div>
          </div>
        </div>
        <div class="image-option">
          <label for="quality">Compression Quality:</label>
          <div class="range-container">
            <input
              type="range"
              id="quality"
              min="0"
              max="100"
              value="80"
              step="1"
            />
            <span id="qualityValue">80%</span>
          </div>
        </div>
        <div class="image-option">
          <label for="outputFormat">Output Format:</label>
          <div class="custom-select-wrapper">
            <select id="outputFormat" class="custom-select">
              <option value="image/jpeg" selected>JPEG</option>
              <option value="image/png">PNG</option>
            </select>
            <span class="custom-select-arrow"></span>
          </div>
        </div>
        <div class="image-option preview-container">
          <label>Image Preview:</label>
          <div class="preview-wrapper">
            <img id="imagePreview" src="link" alt="Image Preview" />
          </div>
        </div>
        <div class="image-buttons">
          <button class="btn btn-secondary" onclick="compressImage()">
            Compress
          </button>
          <button
            class="btn btn-secondary"
            id="downloadButton"
            onclick="downloadImage()"
          >
            Download
          </button>
          <button class="btn btn-secondary" onclick="clearInputs()">
            Clear
          </button>
        </div>
        <div id="resultContainer">
          <pre id="resultOutput"></pre>
        </div>
      </section>
    </main>

    <footer>
      <div class="footer-content">
        <div class="footer-links">
          <a href="#" class="footer-link" onclick="showModal('about')">About</a>
          <a href="#" class="footer-link" onclick="showModal('skills')"
            >Skills</a
          >
          <a href="#" class="footer-link" onclick="showModal('cookies')"
            >Cookies</a
          >
          <a href="/en/privacy-policy.html" class="footer-link"
            >Privacy Policy</a
          >
          <a href="/en/terms-policy.html" class="footer-link">Terms of Use</a>
          <a href="#" class="footer-link" onclick="showModal('contact')"
            >Contact</a
          >
          <a href="/en/support.html" class="footer-link">Support Us</a>
          <a
            href="https://github.com/swizra/soyth.ch"
            class="footer-link"
            target="_blank"
            >GitHub</a
          >
        </div>
        <div class="footer-bottom">
          <div class="custom-language-selector">
            <button class="btn language-toggle" onclick="toggleLanguageMenu()">
              <span id="selectedLanguage">English</span>
            </button>
            <ul class="language-menu" id="languageMenu">
              <li>
                <a href="/en/" onclick="selectLanguage('en', 'English')"
                  >English</a
                >
              </li>
              <li>
                <a href="/de/" onclick="selectLanguage('de', 'Deutsch')"
                  >Deutsch</a
                >
              </li>
              <li>
                <a href="/fr/" onclick="selectLanguage('fr', 'Français')"
                  >Français</a
                >
              </li>
              <li>
                <a href="/it/" onclick="selectLanguage('it', 'Italiano')"
                  >Italiano</a
                >
              </li>
              <li>
                <a href="/rm/" onclick="selectLanguage('rm', 'Rumantsch')"
                  >Rumantsch</a
                >
              </li>
            </ul>
          </div>
          <p class="footer-copyright">
            © <span id="currentYear"></span> Soyth.
          </p>
        </div>
      </div>
    </footer>

    <div id="aboutModal" class="modal">
      <div class="modal-content">
        <h2>About</h2>
        <p>
          Soyth provides a platform with enterprise IT tools built with HTML,
          CSS, and JavaScript to enhance productivity and streamline processes
          for businesses and developers.
        </p>
        <p>
          Explore the source code and contribute to projects via the provided
          links.
        </p>
        <div class="modal-buttons">
          <button
            class="btn btn-secondary"
            onclick="window.location.href='/en/about.html'"
          >
            Learn More
          </button>
          <button class="btn btn-primary" onclick="closeModal('aboutModal')">
            Close
          </button>
        </div>
      </div>
    </div>

    <div id="skillsModal" class="modal">
      <div class="modal-content">
        <h2>Skills</h2>
        <p>
          Expertise in tools, frameworks, and methodologies to deliver efficient
          enterprise IT solutions, with a focus on collaboration and
          productivity.
        </p>
        <p>
          Check out the skills section or contact us for collaboration
          opportunities.
        </p>
        <div class="modal-buttons">
          <button
            class="btn btn-secondary"
            onclick="window.location.href='/en/skills.html'"
          >
            Learn More
          </button>
          <button class="btn btn-primary" onclick="closeModal('skillsModal')">
            Close
          </button>
        </div>
      </div>
    </div>

    <div id="cookiesModal" class="modal">
      <div class="modal-content">
        <h2>Cookie Policy</h2>
        <p>
          We use cookies to enhance your experience on our website. Essential
          cookies are necessary for the site’s operation and cannot be disabled.
          We may also use Google Analytics to collect anonymous usage data to
          improve our services, but this is only enabled with your consent.
        </p>
        <p>
          You can manage your cookie preferences at any time by clicking “Manage
          Cookies” in the cookie banner or footer. For more details, see our
          <a href="/en/cookie-policy.html" class="cookie-link" target="_blank"
            >Cookie Policy</a
          >.
        </p>
        <div class="modal-buttons">
          <button class="btn" onclick="showModal('cookiePreferences')">
            Manage
          </button>
          <button class="btn btn-primary" onclick="closeModal('cookiesModal')">
            Close
          </button>
        </div>
      </div>
    </div>

    <div id="cookiePreferencesModal" class="modal">
      <div class="modal-content">
        <h2>Manage Cookie Preferences</h2>
        <p>Adjust which cookies we can use.</p>
        <div class="cookie-options">
          <div class="cookie-option">
            <input type="checkbox" id="essentialCookies" checked disabled />
            <label for="essentialCookies"
              >Essential Cookies (required for site operation)</label
            >
          </div>
          <div class="cookie-option">
            <input type="checkbox" id="analyticsCookies" />
            <label for="analyticsCookies"
              >Analytics Cookies (help us understand site performance via Google
              Analytics)</label
            >
          </div>
          <div class="cookie-option">
            <input type="checkbox" id="marketingCookies" />
            <label for="marketingCookies"
              >Marketing Cookies (support our marketing initiatives)</label
            >
          </div>
        </div>
        <div class="modal-buttons">
          <button class="btn" onclick="closeModal('cookiePreferencesModal')">
            Cancel
          </button>
          <button class="btn btn-primary" onclick="saveCookiePreferences()">
            Save
          </button>
        </div>
      </div>
    </div>

    <div id="contactModal" class="modal">
      <div class="modal-content">
        <h2>Contact</h2>
        <p>
          Interested in collaboration or have questions? Reach out to us via
          email for direct communication.
        </p>
        <p>
          No personal data is collected, ensuring your privacy and security.
        </p>
        <div class="modal-buttons">
          <a href="mailto:hello@soyth.ch" class="btn btn-primary">Send Email</a>
          <button class="btn" onclick="closeModal('contactModal')">
            Close
          </button>
        </div>
      </div>
    </div>

    <script>
      function loadGoogleAnalytics() {
        const consent = JSON.parse(
          localStorage.getItem("cookieConsent") || "{}"
        );
        if (consent.analytics) {
          const script = document.createElement("script");
          script.async = true;
          script.src =
            "https://www.googletagmanager.com/gtag/js?id=G-T9JP67T6DX";
          document.head.appendChild(script);
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag("js", new Date());
          gtag("config", "G-T9JP67T6DX", { anonymize_ip: true });
        }
      }
      function showCookieBanner() {
        const cookieConsent = localStorage.getItem("cookieConsent");
        if (!cookieConsent) {
          document.getElementById("cookieBanner").style.display = "block";
        }
      }
      function acceptAllCookies() {
        localStorage.setItem(
          "cookieConsent",
          JSON.stringify({
            essential: true,
            analytics: true,
            marketing: true,
          })
        );
        document.getElementById("cookieBanner").style.display = "none";
        loadGoogleAnalytics();
      }
      function rejectNonEssentialCookies() {
        localStorage.setItem(
          "cookieConsent",
          JSON.stringify({
            essential: true,
            analytics: false,
            marketing: false,
          })
        );
        document.getElementById("cookieBanner").style.display = "none";
      }
      function showModal(type) {
        event.preventDefault();
        const modals = document.querySelectorAll(".modal");
        modals.forEach((modal) => {
          modal.style.display = "none";
        });
        document.body.classList.remove("no-scroll");
        const modal = document.getElementById(type + "Modal");
        if (modal) {
          if (type === "cookiePreferences") {
            const consent = JSON.parse(
              localStorage.getItem("cookieConsent") || "{}"
            );
            document.getElementById("analyticsCookies").checked =
              consent.analytics || false;
            document.getElementById("marketingCookies").checked =
              consent.marketing || false;
          }
          modal.style.display = "block";
          document.body.classList.add("no-scroll");
          document.querySelector(".logo").classList.remove("logo-hidden");
        }
      }
      function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
          modal.style.display = "none";
          document.body.classList.remove("no-scroll");
        }
      }
      function saveCookiePreferences() {
        const preferences = {
          essential: true,
          analytics: document.getElementById("analyticsCookies").checked,
          marketing: document.getElementById("marketingCookies").checked,
        };
        localStorage.setItem("cookieConsent", JSON.stringify(preferences));
        document.getElementById("cookiePreferencesModal").style.display =
          "none";
        document.getElementById("cookieBanner").style.display = "none";
        document.body.classList.remove("no-scroll");
        if (preferences.analytics) {
          loadGoogleAnalytics();
        }
      }
      function detectAndRedirectLanguage() {
        const userLang = (
          navigator.language || navigator.userLanguage
        ).toLowerCase();
        const supportedLangs = {
          en: "/en/ImageCompressor.html",
          de: "/de/ImageCompressor.html",
          fr: "/fr/ImageCompressor.html",
          it: "/it/ImageCompressor.html",
          rm: "/rm/ImageCompressor.html",
        };
        let selectedLang = "en";
        for (const lang in supportedLangs) {
          if (userLang.startsWith(lang)) {
            selectedLang = lang;
            break;
          }
        }
        const currentPath = window.location.pathname;
        if (
          !Object.values(supportedLangs).some((path) =>
            currentPath.startsWith(path)
          )
        ) {
          window.location.href = supportedLangs[selectedLang];
        } else {
          const langCode = currentPath.split("/")[1] || "en";
          const langText = {
            en: "English",
            de: "Deutsch",
            fr: "Français",
            it: "Italiano",
            rm: "Rumantsch",
          }[langCode];
          document.getElementById("selectedLanguage").textContent = langText;
        }
      }
      function toggleTheme() {
        const body = document.body;
        const themeIcon = document.getElementById("themeIcon");
        const mobileThemeIcon = document.getElementById("mobileThemeIcon");
        const isDark = body.classList.toggle("dark");
        themeIcon.textContent = isDark ? "Light" : "Dark";
        mobileThemeIcon.textContent = isDark ? "Light" : "Dark";
        localStorage.setItem("theme", isDark ? "dark" : "light");
      }
      function initTheme() {
        const savedTheme = localStorage.getItem("theme");
        const prefersDark = window.matchMedia(
          "(prefers-color-scheme: dark)"
        ).matches;
        const shouldUseDark = savedTheme ? savedTheme === "dark" : prefersDark;
        if (shouldUseDark) {
          document.body.classList.add("dark");
          document.getElementById("themeIcon").textContent = "Light";
          document.getElementById("mobileThemeIcon").textContent = "Light";
        }
      }
      function toggleMobileMenu() {
        const mobileNav = document.getElementById("mobileNav");
        const burgerMenu = document.querySelector(".burger-menu");
        const logo = document.querySelector(".logo");
        const isActive = mobileNav.classList.contains("active");
        if (isActive) {
          mobileNav.classList.remove("active");
          burgerMenu.classList.remove("active");
          logo.classList.remove("logo-hidden");
          document.body.classList.remove("no-scroll");
        } else {
          mobileNav.classList.add("active");
          burgerMenu.classList.add("active");
          logo.classList.add("logo-hidden");
          document.body.classList.add("no-scroll");
        }
      }
      function closeMobileMenu() {
        const burger = document.querySelector(".burger-menu");
        const mobileNav = document.getElementById("mobileNav");
        burger.classList.remove("active");
        mobileNav.classList.remove("active");
      }
      function shareTool(title, url) {
        if (navigator.share) {
          navigator
            .share({
              title: title,
              text: `Check out this open-source enterprise IT tool: ${title}`,
              url: url,
            })
            .catch((error) => console.log("Error sharing:", error));
        } else {
          navigator.clipboard
            .writeText(url)
            .then(() => {
              alert("Link copied to clipboard!");
            })
            .catch((err) => {
              console.log("Failed to copy link:", err);
              alert("Failed to copy link to clipboard");
            });
        }
      }
      function filterProjects() {
        const searchInput = document
          .getElementById("projectSearch")
          .value.toLowerCase();
        const toolCards = document.querySelectorAll(".tool-card");
        toolCards.forEach((card) => {
          const title = card.querySelector("h3").textContent.toLowerCase();
          const tech = card
            .querySelector(".tool-tech")
            .textContent.toLowerCase();
          if (title.includes(searchInput) || tech.includes(searchInput)) {
            card.style.display = "flex";
          } else {
            card.style.display = "none";
          }
        });
      }
      function toggleLanguageMenu() {
        const menu = document.getElementById("languageMenu");
        const isActive = menu.classList.toggle("active");
        document.body.classList.toggle("no-scroll", isActive);
        if (isActive) {
          const toggleButton = document.querySelector(".language-toggle");
          const menuWidth = toggleButton.offsetWidth;
          menu.style.width = `${menuWidth}px`;
        }
      }
      function selectLanguage(lang, text) {
        document.getElementById("selectedLanguage").textContent = text;
        document.getElementById("languageMenu").classList.remove("active");
        document.body.classList.remove("no-scroll");
      }
      window.addEventListener("click", function (event) {
        const languageSelector = document.querySelector(
          ".custom-language-selector"
        );
        if (!languageSelector.contains(event.target)) {
          document.getElementById("languageMenu").classList.remove("active");
          document.body.classList.remove("no-scroll");
        }
      });
      window.onclick = function (event) {
        const modals = document.querySelectorAll(".modal");
        modals.forEach((modal) => {
          if (event.target === modal) {
            modal.style.display = "none";
            document.body.classList.remove("no-scroll");
          }
        });
      };
      document.addEventListener("keydown", function (event) {
        if (event.key === "Escape") {
          const modals = document.querySelectorAll(".modal");
          modals.forEach((modal) => {
            if (modal.style.display === "block") {
              modal.style.display = "none";
              document.body.classList.remove("no-scroll");
            }
          });
          document.getElementById("languageMenu").classList.remove("active");
          document.getElementById("projectsNav").classList.remove("active");
          document.body.classList.remove("no-scroll");
          closeMobileMenu();
        }
      });
      document.addEventListener("DOMContentLoaded", function () {
        initTheme();
        document.getElementById("currentYear").textContent =
          new Date().getFullYear();
        detectAndRedirectLanguage();
        showCookieBanner();
        loadGoogleAnalytics();
        document
          .getElementById("imageInput")
          .addEventListener("change", handleImageSelection);
        document
          .getElementById("quality")
          .addEventListener("input", updateQualityValue);
        document
          .getElementById("outputFormat")
          .addEventListener("change", compressImage);
      });
      window
        .matchMedia("(prefers-color-scheme: dark)")
        .addEventListener("change", function (e) {
          if (!localStorage.getItem("theme")) {
            if (e.matches) {
              document.body.classList.add("dark");
              document.getElementById("themeIcon").textContent = "Light";
              document.getElementById("mobileThemeIcon").textContent = "Light";
            } else {
              document.body.classList.remove("dark");
              document.getElementById("themeIcon").textContent = "Dark";
              document.getElementById("mobileThemeIcon").textContent = "Dark";
            }
          }
        });
    </script>
    <script>
      let compressedImageBlob = null;

      function formatFileSize(bytes) {
        if (bytes < 1024) return `${bytes} B`;
        if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(2)} KB`;
        return `${(bytes / (1024 * 1024)).toFixed(2)} MB`;
      }

      function handleImageSelection(event) {
        const file = event.target.files[0];
        const fileNameDisplay = document.getElementById("fileName");
        const imagePreview = document.getElementById("imagePreview");
        const resultOutput = document.getElementById("resultOutput");
        const previewContainer = document.querySelector(".preview-container");
        const resultContainer = document.getElementById("resultContainer");

        if (!file) {
          fileNameDisplay.textContent = "No file chosen";
          imagePreview.src = "";
          imagePreview.style.display = "none";
          previewContainer.classList.remove("active");
          resultContainer.classList.remove("active");
          resultOutput.textContent = "";
          compressedImageBlob = null;
          document.getElementById("downloadButton").disabled = true;
          return;
        }

        if (!file.type.match("image/jpeg|image/png")) {
          resultOutput.textContent =
            "Please select a valid image file (JPEG or PNG).";
          fileNameDisplay.textContent = "No file chosen";
          imagePreview.src = "";
          imagePreview.style.display = "none";
          previewContainer.classList.remove("active");
          resultContainer.classList.add("active");
          compressedImageBlob = null;
          document.getElementById("downloadButton").disabled = true;
          return;
        }

        fileNameDisplay.textContent = file.name;
        const reader = new FileReader();
        reader.onload = function (e) {
          imagePreview.src = e.target.result;
          imagePreview.style.display = "block";
          previewContainer.classList.add("active");
          resultContainer.classList.add("active");
          compressImage();
        };
        reader.readAsDataURL(file);
      }

      function clearInputs() {
        document.getElementById("imageInput").value = "";
        document.getElementById("fileName").textContent = "No file chosen";
        document.getElementById("imagePreview").src = "";
        document.getElementById("imagePreview").style.display = "none";
        document.querySelector(".preview-container").classList.remove("active");
        document.getElementById("resultContainer").classList.remove("active");
        document.getElementById("quality").value = 80;
        document.getElementById("qualityValue").textContent = "80%";
        document.getElementById("outputFormat").value = "image/jpeg";
        document.getElementById("resultOutput").textContent = "";
        document.getElementById("downloadButton").disabled = true;
        compressedImageBlob = null;
      }

      function updateQualityValue() {
        const quality = document.getElementById("quality").value;
        document.getElementById("qualityValue").textContent = `${quality}%`;
        compressImage();
      }

      function compressImage() {
        const imageInput = document.getElementById("imageInput");
        const quality = document.getElementById("quality").value / 100;
        const outputFormat = document.getElementById("outputFormat").value;
        const resultOutput = document.getElementById("resultOutput");
        const downloadButton = document.getElementById("downloadButton");
        const imagePreview = document.getElementById("imagePreview");

        if (!imageInput.files[0]) {
          resultOutput.textContent = "Please select an image to compress.";
          downloadButton.disabled = true;
          return;
        }

        const file = imageInput.files[0];
        const originalSize = file.size;
        const img = new Image();
        img.onload = function () {
          const canvas = document.createElement("canvas");
          const ctx = canvas.getContext("2d");

          // Maintain aspect ratio, limit max dimensions
          const maxDimension = 1920; // Max width or height
          let width = img.width;
          let height = img.height;

          if (width > height && width > maxDimension) {
            height = (height * maxDimension) / width;
            width = maxDimension;
          } else if (height > maxDimension) {
            width = (width * maxDimension) / height;
            height = maxDimension;
          }

          canvas.width = width;
          canvas.height = height;
          ctx.drawImage(img, 0, 0, width, height);

          // Compress image
          canvas.toBlob(
            (blob) => {
              if (!blob) {
                resultOutput.textContent = "Failed to compress image.";
                downloadButton.disabled = true;
                compressedImageBlob = null;
                return;
              }

              compressedImageBlob = blob;
              const compressedSize = blob.size;
              resultOutput.textContent = `Original Size: ${formatFileSize(
                originalSize
              )}\nCompressed Size: ${formatFileSize(
                compressedSize
              )}\nReduction: ${(
                ((originalSize - compressedSize) / originalSize) *
                100
              ).toFixed(2)}%`;
              downloadButton.disabled = false;

              // Update preview with compressed image
              const reader = new FileReader();
              reader.onload = function (e) {
                imagePreview.src = e.target.result;
              };
              reader.readAsDataURL(blob);
            },
            outputFormat,
            outputFormat === "image/jpeg" ? quality : 1 // PNG doesn't use quality
          );
        };
        img.onerror = function () {
          resultOutput.textContent = "Error loading image.";
          downloadButton.disabled = true;
          compressedImageBlob = null;
        };
        img.src = URL.createObjectURL(file);
      }

      function downloadImage() {
        if (!compressedImageBlob) {
          document.getElementById("resultOutput").textContent =
            "No compressed image available.";
          return;
        }

        const fileName = document
          .getElementById("fileName")
          .textContent.replace(/\.[^/.]+$/, "");
        const extension = document
          .getElementById("outputFormat")
          .value.includes("jpeg")
          ? "jpg"
          : "png";
        const link = document.createElement("a");
        link.href = URL.createObjectURL(compressedImageBlob);
        link.download = `${fileName}_compressed.${extension}`;
        link.click();
        URL.revokeObjectURL(link.href);
      }
    </script>
    <script>
      let lastScrollTop = 0;
      let isButtonVisible = false;
      let lastDirectionChangePosition = 0;

      function updateScrollButton() {
        const scrollTop =
          window.pageYOffset || document.documentElement.scrollTop;
        const windowHeight = window.innerHeight;
        const documentHeight = document.documentElement.scrollHeight;
        const scrollButton = document.getElementById("scrollButton");
        const scrollDistance = Math.abs(
          scrollTop - lastDirectionChangePosition
        );

        if (
          scrollTop > 100 &&
          scrollTop < documentHeight - windowHeight - 100
        ) {
          if (!isButtonVisible) {
            scrollButton.style.opacity = "1";
            scrollButton.style.pointerEvents = "auto";
            isButtonVisible = true;
          }
        } else {
          scrollButton.style.opacity = "0";
          scrollButton.style.pointerEvents = "none";
          isButtonVisible = false;
        }

        if (scrollDistance >= 100) {
          if (scrollTop > lastScrollTop) {
            scrollButton.classList.add("rotate-down");
            scrollButton.setAttribute("data-direction", "bottom");
          } else if (scrollTop < lastScrollTop) {
            scrollButton.classList.remove("rotate-down");
            scrollButton.setAttribute("data-direction", "top");
          }
          lastDirectionChangePosition = scrollTop;
        }

        lastScrollTop = Math.max(scrollTop, 0);
      }

      function scrollToDirection() {
        const scrollButton = document.getElementById("scrollButton");
        const direction = scrollButton.getAttribute("data-direction");
        if (direction === "top") {
          window.scrollTo({ top: 0, behavior: "smooth" });
        } else {
          window.scrollTo({
            top: document.documentElement.scrollHeight,
            behavior: "smooth",
          });
        }
      }

      window.addEventListener("scroll", updateScrollButton);
    </script>
    <script>
      function showProjectsMenu() {
        event.preventDefault();
        const projectsNav = document.getElementById("projectsNav");
        const mobileNav = document.getElementById("mobileNav");
        projectsNav.classList.add("active");
        mobileNav.classList.remove("active");
        document.querySelector(".burger-menu").classList.remove("active");
        document.body.classList.add("no-scroll");
      }

      function closeProjectsMenu() {
        const projectsNav = document.getElementById("projectsNav");
        projectsNav.classList.remove("active");
        document.body.classList.remove("no-scroll");
        if (window.innerWidth <= 768) {
          document.querySelector(".burger-menu").classList.add("active");
          document.getElementById("mobileNav").classList.add("active");
        }
      }
    </script>
  </body>
</html>
